<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aula: Express√µes Regulares para Processos Jur√≠dicos</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            line-height: 1.6; 
            margin: 0; 
            padding: 20px; 
            background: #f8f9fa; 
            color: #333;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            padding: 40px; 
            border-radius: 12px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        h1 { 
            color: #2c3e50; 
            text-align: center; 
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }
        h2 { 
            color: #34495e; 
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 40px;
        }
        h3 { 
            color: #2c3e50; 
            margin-top: 30px;
        }
        pre { 
            background: #2d3748; 
            color: #e2e8f0;
            padding: 20px; 
            border-radius: 8px; 
            overflow-x: auto;
            margin: 15px 0;
        }
        code {
            background: #f1f5f9;
            color: #1e293b;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
        }
        pre code {
            background: none;
            color: #e2e8f0;
            padding: 0;
        }
        .highlight {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #f8f9fa;
            font-weight: 600;
        }
        .link { 
            background: #3498db; 
            color: white; 
            padding: 12px 24px; 
            text-decoration: none; 
            border-radius: 6px; 
            display: inline-block; 
            margin: 15px 5px 15px 0;
            transition: background 0.3s;
        }
        .link:hover {
            background: #2980b9;
        }
        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc li {
            margin: 8px 0;
        }
        .toc a {
            color: #3498db;
            text-decoration: none;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        .emoji {
            font-size: 1.2em;
        }
        blockquote {
            border-left: 4px solid #3498db;
            margin: 20px 0;
            padding: 10px 20px;
            background: #f8f9fa;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìö Material Did√°tico: Express√µes Regulares para An√°lise de Processos Jur√≠dicos</h1>
        
        <div class="highlight">
            <strong>üéØ Objetivo da Aula:</strong> Desenvolver compet√™ncias pr√°ticas em express√µes regulares para extrair informa√ß√µes espec√≠ficas de textos jur√≠dicos, aplicando-as ao desafio de identificar processos sobre cr√©dito consignado e valores de indeniza√ß√£o.
        </div>

        <div class="toc">
            <h3>üìã Sum√°rio</h3>
            <ul>
                <li><a href="#importacao">1. Importa√ß√£o e Compreens√£o dos Dados</a></li>
                <li><a href="#limpeza">2. Normaliza√ß√£o e Limpeza dos Dados</a></li>
                <li><a href="#regex">3. Express√µes Regulares Aplicadas</a></li>
                <li><a href="#validacao">4. Valida√ß√£o do Modelo</a></li>
                <li><a href="#exercicios">5. Exerc√≠cios Pr√°ticos</a></li>
                <li><a href="#padroes">6. Padr√µes Regex √öteis</a></li>
            </ul>
        </div>

        <h2 id="importacao">1. IMPORTA√á√ÉO E COMPREENS√ÉO DOS DADOS</h2>

        <h3>1.1 Estrutura do Dataset</h3>
        <p>Nosso dataset (<code>dataset_clinica20252.csv</code>) cont√©m <strong>2.959 registros</strong> com as seguintes colunas:</p>

        <table>
            <thead>
                <tr>
                    <th>Campo</th>
                    <th>Descri√ß√£o</th>
                    <th>Caracter√≠sticas</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>cd_causa</code></td>
                    <td>C√≥digo identificador do caso</td>
                    <td>10 caracteres, formato: CIB + n√∫meros</td>
                </tr>
                <tr>
                    <td><code>cd_atendimento</code></td>
                    <td>N√∫mero do processo</td>
                    <td>25 caracteres, formato: NNNNNN-XX.YYYY.Z.AA.BBBB</td>
                </tr>
                <tr>
                    <td><code>ds_Acao_Judicial</code></td>
                    <td>Tipo da a√ß√£o</td>
                    <td>Predominantemente "90 - ACAO DE REPARACAO DE DANOS"</td>
                </tr>
                <tr>
                    <td><code>ds_fatos</code></td>
                    <td>Descri√ß√£o dos fatos</td>
                    <td>Texto longo (at√© 5.000 caracteres)</td>
                </tr>
                <tr>
                    <td><code>ds_Pedidos</code></td>
                    <td>Pedidos do autor</td>
                    <td>Texto longo (at√© 5.000 caracteres)</td>
                </tr>
                <tr>
                    <td><code>ds_Qualificacao</code></td>
                    <td>Qualifica√ß√£o das partes</td>
                    <td>Dados das partes envolvidas</td>
                </tr>
            </tbody>
        </table>

        <h3>1.2 C√≥digo de Importa√ß√£o</h3>
        <pre><code>import pandas as pd
import re
import numpy as np

# Importa√ß√£o do dataset
df = pd.read_csv('dataset_clinica20252.csv', delimiter='|', encoding='utf-8')

# Verifica√ß√£o b√°sica
print(f"Total de registros: {len(df)}")
print(f"Colunas: {list(df.columns)}")
print(f"Registros com dados completos: {df.dropna().shape[0]}")
</code></pre>

        <h2 id="limpeza">2. NORMALIZA√á√ÉO E LIMPEZA DOS DADOS</h2>

        <h3>2.1 Problemas Identificados</h3>
        <ol>
            <li><strong>Encoding:</strong> Caracteres especiais (√É, ¬©, ¬™)</li>
            <li><strong>Formata√ß√£o:</strong> Texto em CAPS, espa√ßamentos irregulares</li>
            <li><strong>Inconsist√™ncias:</strong> Varia√ß√µes na escrita de valores monet√°rios</li>
        </ol>

        <h3>2.2 C√≥digo de Limpeza</h3>
        <pre><code>def clean_text(text):
    """Fun√ß√£o para limpeza b√°sica de texto jur√≠dico"""
    if pd.isna(text):
        return ""
    
    # Corre√ß√£o de encoding comum
    replacements = {
        '√É∆í√Ç¬°': '√°', '√É∆í ': '√†', '√É∆í√Ç¬£': '√£', '√É∆í√Ç¬©': '√©', '√É∆í√Ç¬≠': '√≠', 
        '√É∆í√Ç¬≥': '√≥', '√É∆í√Ç¬∫': '√∫', '√É∆í√Ç¬ß': '√ß', '√É∆í√Ç¬™': '√™', '√É∆í√Ç¬¥': '√¥'
    }
    
    text = str(text)
    for old, new in replacements.items():
        text = text.replace(old, new)
    
    # Normaliza√ß√£o de espa√ßos
    text = re.sub(r'\s+', ' ', text)
    text = text.strip()
    
    return text

# Aplicar limpeza
df['ds_fatos_clean'] = df['ds_fatos'].apply(clean_text)
df['ds_Pedidos_clean'] = df['ds_Pedidos'].apply(clean_text)
</code></pre>

        <h2 id="regex">3. EXPRESS√ïES REGULARES APLICADAS</h2>

        <h3>3.1 Identifica√ß√£o de Processos sobre Cr√©dito Consignado</h3>
        <p><strong>Objetivo:</strong> Identificar processos relacionados a empr√©stimos consignados</p>

        <pre><code>def is_credito_consignado(texto):
    """Identifica processos sobre cr√©dito consignado usando regex"""
    
    # Padr√µes principais
    patterns = [
        r'cr[e√©]dito\s+consignado',
        r'empr[e√©]stimo\s+consignado',
        r'consigna[√ßc][√£a]o',
        r'desconto\s+(?:em\s+)?folha',
        r'margem\s+consign[a√°]vel',
        r'benef[√≠i]cio\s+(?:do\s+)?INSS.*desconto',
        r'aposentadoria.*empr[e√©]stimo',
        r'desconto\s+(?:indevido|fraudulento).*benef[√≠i]cio'
    ]
    
    # Busca por padr√µes (case insensitive)
    for pattern in patterns:
        if re.search(pattern, texto, re.IGNORECASE):
            return True
    
    return False

# Aplicar identifica√ß√£o
df['is_consignado'] = df.apply(
    lambda row: is_credito_consignado(row['ds_fatos_clean'] + ' ' + row['ds_Pedidos_clean']), 
    axis=1
)

print(f"Processos identificados como cr√©dito consignado: {df['is_consignado'].sum()}")
</code></pre>

        <h3>3.2 Extra√ß√£o de Valores de Indeniza√ß√£o</h3>
        <p><strong>Objetivo:</strong> Extrair valores monet√°rios pedidos a t√≠tulo de indeniza√ß√£o</p>

        <pre><code>def extract_valores_indenizacao(texto):
    """Extrai valores de indeniza√ß√£o usando regex"""
    
    valores = []
    
    # Padr√£o 1: R$ XXX,XX ou R$ X.XXX,XX
    pattern_moeda = r'R\$\s*(\d{1,3}(?:\.\d{3})*(?:,\d{2})?)'
    matches_moeda = re.findall(pattern_moeda, texto)
    
    for match in matches_moeda:
        # Converter para float
        valor_str = match.replace('.', '').replace(',', '.')
        try:
            valor = float(valor_str)
            valores.append(valor)
        except:
            continue
    
    # Padr√£o 2: Valores por extenso seguidos de par√™nteses
    pattern_extenso = r'(\d+)\s*(?:\([a-z\s]+\))?\s*sal√°rios?[\s-]m[√≠i]nimos?'
    matches_extenso = re.findall(pattern_extenso, texto, re.IGNORECASE)
    
    # Converter sal√°rios m√≠nimos (assumindo R$ 1.518,00 em 2025)
    salario_minimo = 1518.00
    for match in matches_extenso:
        try:
            qtd_salarios = int(match)
            valor = qtd_salarios * salario_minimo
            valores.append(valor)
        except:
            continue
    
    return valores

# Aplicar extra√ß√£o nos pedidos
df['valores_indenizacao'] = df['ds_Pedidos_clean'].apply(extract_valores_indenizacao)

# Separar em colunas para an√°lise
df['maior_valor'] = df['valores_indenizacao'].apply(lambda x: max(x) if x else np.nan)
df['total_valores'] = df['valores_indenizacao'].apply(lambda x: sum(x) if x else np.nan)
df['qtd_valores'] = df['valores_indenizacao'].apply(len)
</code></pre>

        <h2 id="validacao">4. VALIDA√á√ÉO DO MODELO</h2>

        <h3>4.1 M√©tricas de Valida√ß√£o</h3>
        <pre><code># Valida√ß√£o manual de uma amostra
def validate_sample(df, n=50):
    """Valida uma amostra dos resultados"""
    
    sample = df.sample(n=n)
    
    print("=== VALIDA√á√ÉO DE CR√âDITO CONSIGNADO ===")
    for idx, row in sample.iterrows():
        texto = row['ds_fatos_clean'][:200] + "..."
        pred = row['is_consignado']
        print(f"Processo {row['cd_atendimento']}")
        print(f"Predi√ß√£o: {pred}")
        print(f"Texto: {texto}")
        print("-" * 50)

# Estat√≠sticas descritivas
print("=== ESTAT√çSTICAS GERAIS ===")
print(f"Processos de cr√©dito consignado: {df['is_consignado'].sum()}/{len(df)} ({100*df['is_consignado'].mean():.1f}%)")
print(f"Processos com valores identificados: {df['qtd_valores'].gt(0).sum()}")
print(f"Valor m√©dio de indeniza√ß√£o: R$ {df['maior_valor'].mean():.2f}")
</code></pre>

        <h2 id="exercicios">5. EXERC√çCIOS PR√ÅTICOS</h2>

        <div class="highlight">
            <h3>üí° Exerc√≠cio 1: Melhoria dos Padr√µes</h3>
            <p>Analise os falsos positivos/negativos e melhore os padr√µes regex para cr√©dito consignado.</p>
            
            <h3>üí° Exerc√≠cio 2: Extra√ß√£o de Datas</h3>
            <p>Crie regex para extrair datas relevantes dos processos (data do empr√©stimo, in√≠cio dos descontos).</p>
            
            <h3>üí° Exerc√≠cio 3: Classifica√ß√£o de Danos</h3>
            <p>Desenvolva padr√µes para classificar tipos de danos pedidos (morais, materiais, est√©ticos).</p>
            
            <h3>üí° Exerc√≠cio 4: Valida√ß√£o Cruzada</h3>
            <p>Implemente valida√ß√£o cruzada para medir a precis√£o dos seus padr√µes.</p>
        </div>

        <h2 id="padroes">6. PADR√ïES REGEX √öTEIS</h2>

        <h3>6.1 Valores Monet√°rios</h3>
        <pre><code># Valores em reais com diferentes formatos
r'R\$\s*(\d{1,3}(?:\.\d{3})*(?:,\d{2})?)'

# Valores por extenso
r'(\d+(?:\.\d{3})*(?:,\d{2})?)\s*\([^)]+\)\s*reais?'

# Sal√°rios m√≠nimos
r'(\d+)\s*(?:\([^)]+\))?\s*sal[a√°]rios?[\s-]m[√≠i]nimos?'
</code></pre>

        <h3>6.2 Datas</h3>
        <pre><code># DD/MM/YYYY ou DD-MM-YYYY
r'(\d{1,2})[/-](\d{1,2})[/-](\d{4})'

# M√™s/Ano em texto
r'(janeiro|fevereiro|mar√ßo|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)[/\s]*(\d{4})'
</code></pre>

        <h3>6.3 CPF/CNPJ</h3>
        <pre><code># CPF: XXX.XXX.XXX-XX
r'\d{3}\.\d{3}\.\d{3}-\d{2}'

# CNPJ: XX.XXX.XXX/XXXX-XX  
r'\d{2}\.\d{3}\.\d{3}/\d{4}-\d{2}'
</code></pre>

        <blockquote>
            <h3>üö® Pontos de Aten√ß√£o</h3>
            <ol>
                <li><strong>Performance:</strong> Para datasets grandes, use compila√ß√£o de regex (<code>re.compile()</code>)</li>
                <li><strong>Falsos Positivos:</strong> Sempre valide uma amostra manualmente</li>
                <li><strong>Contexto:</strong> Considere o contexto jur√≠dico espec√≠fico</li>
                <li><strong>Evolu√ß√£o:</strong> Linguagem jur√≠dica muda; padr√µes precisam ser atualizados</li>
                <li><strong>LLM como Fallback:</strong> Use IA para casos complexos que regex n√£o resolve</li>
            </ol>
        </blockquote>

        <h2>üéØ CONCLUS√ÉO</h2>
        <p>As express√µes regulares s√£o fundamentais para a primeira etapa de an√°lise de textos jur√≠dicos, permitindo:</p>
        <ul>
            <li><strong>Identifica√ß√£o automatizada</strong> de tipos de processo</li>
            <li><strong>Extra√ß√£o estruturada</strong> de informa√ß√µes quantitativas</li>
            <li><strong>Classifica√ß√£o inicial</strong> para direcionamento de casos</li>
            <li><strong>Prepara√ß√£o de dados</strong> para an√°lises mais sofisticadas com LLMs</li>
        </ul>

        <p><em>O pr√≥ximo passo ser√° aplicar essas t√©cnicas ao dataset completo e refinar os padr√µes com base nos resultados obtidos.</em></p>

        <div style="text-align: center; margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
            <p><strong>üìß D√∫vidas?</strong> Entre em contato para discuss√£o dos exerc√≠cios!</p>
        </div>
    </div>
</body>
</html>
